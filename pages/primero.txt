# pages/lastfm_search_artist_page.py
from selenium.webdriver.common.by import By
from pages.base_page import BasePage
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

class LastFmSearchArtistPage(BasePage):
 
    SEARCH_ICON = (By.XPATH, "//a[contains(@href, '/search')]")  # botón de lupa
    #SEARCH_BOX = (By.XPATH, '//*[@id="masthead-search-field"]')
    SEARCH_BOX = (By.ID, "masthead-search-field")
    FIRST_RESULT = (By.CSS_SELECTOR, 'button[type="submit"].masthead-search-submit')
    FIND_ARTIST = (By.CSS_SELECTOR, "ol.grid-items li.grid-items-item a")
    ARTIST_DATE  = (By.CSS_SELECTOR, ".artist-header-featured-items-item-date")
  
    def search_artist(self, name):
        # 1️ Abre el cuadro de búsqueda
        self.click(self.SEARCH_ICON)      

        # 2 Escribe el nombre del artista
        self.enter_text(self.SEARCH_BOX, name + "\n")

        #buscar (presionar button)
        self.click(self.FIRST_RESULT)


    def open_first_result(self):
         #escoge la primera opcion
        self.click(self.FIND_ARTIST)


    def get_last_release_date(self):
        try:
            element = WebDriverWait(self.driver, 10).until(
                EC.presence_of_element_located(self.ARTIST_DATE)
            )
            print(" Fecha encontrada:", element.text)
            return element.text
        except Exception as e:
            print(" No se encontró la fecha de lanzamiento:", e)
            return None